/*!
  Copyright (C) Microsoft. All rights reserved.
  This library is supported for use in Windows Store apps only.
*/
function injectJavaScript(n){var t,i,r;try{t=document.createElement("script"),i=document.getElementsByTagName("head")[0],t.innerHTML=n,i.appendChild(t)}catch(u){r=u===null||typeof u=="undefined"?"unknown":u.message,reportAdError("error injecting javascript: "+r)}}function receiveMessage(n){var f,e,c,o,r,s,l,a,v,h;if(typeof localCompartmentOrigin!="undefined"&&n.origin===localCompartmentOrigin&&typeof MSG_TYPE_SCRIPT!="undefined"&&typeof JSON!="undefined"){localCompartment===null&&(localCompartment=n.source);var i=null,t=null,u=n.data.indexOf(":");if(u<0?i=n.data:(i=n.data.substr(0,u),t=n.data.substr(u+1)),i===MSG_TYPE_SCRIPT)t!==""&&injectJavaScript(t);else if(i===MSG_TYPE_ADPARAMS){if(t!=="")try{adParams=JSON.parse(t)}catch(y){reportAdError("Ad params JSON parse error: "+y.message)}}else if(i===MSG_TYPE_PRMPARAMS){if(t!=="")try{prmParams=JSON.parse(t)}catch(y){reportAdError("Prm params JSON parse error: "+y.message)}}else if(i===MSG_TYPE_APPPARAMS){if(t!=="")try{appParams=JSON.parse(t)}catch(y){reportAdError("App params JSON parse error: "+y.message)}}else if(i===MSG_TYPE_SETID)adControlId=t;else if(i===MSG_TYPE_INIT){Ormma.getState()==="expanded"&&(document.attachEvent("onkeyup",function(n){n.keyCode===27&&Ormma.close()}),f=document.getElementById("adBody"),f!==null&&f.focus());try{window.renderer=new microsoft.advertising.renderer,window.renderer.init({creativeData:adParams,container:msMainAdDiv.id,prm:prmParams,appOptions:appParams})}catch(n){reportAdError("unable to initialize renderer: "+n);return}try{window.renderer.renderAd(),postToLocal(MSG_TYPE_ADINITIALIZED)}catch(n){reportAdError("unable to render ad: "+n)}}else i===MSG_TYPE_SETADINSTANCESTATE?Ormma._setAdInstanceState(t):typeof Ormma!="undefined"&&Ormma!==null&&(i===MSG_TYPE_SETSIZE?(e=JSON.parse(t),Ormma._setSize(e.width,e.height)):i===MSG_TYPE_SETMAXSIZE?(c=JSON.parse(t),Ormma._maxSize=c):i===MSG_TYPE_SETSCREENSIZE?(o=JSON.parse(t),Ormma._setScreenSize(o.width,o.height)):i===MSG_TYPE_SETSTATE?Ormma._setState(t):i===MSG_TYPE_SETLOCALE?Ormma._setLocale(t):i===MSG_TYPE_SETSDKINFO?(r=JSON.parse(t),Ormma._setSdkVersion(r.sdkVersion,r.client,r.runtimeType)):i===MSG_TYPE_SETCAPABILITY?(s=JSON.parse(t),Ormma._setCapability(s.capability,s.value)):i===MSG_TYPE_START?Ormma._init(t):i===MSG_TYPE_FIRESHAKE?Ormma._shake():i===MSG_TYPE_ORMMA_RESPONSE?Ormma._sendResponse(JSON.parse(t)):i===MSG_TYPE_UPDATETILTCOORDS?(l=JSON.parse(t),Ormma._tiltChange(l)):i===MSG_TYPE_VIEWABLECHANGE?(a=JSON.parse(t),Ormma._viewableChange(a.viewable)):i===MSG_TYPE_UPDATEORIENTATION?(v=JSON.parse(t),Ormma._setOrientation(v.orientation)):i===MSG_TYPE_SETNETWORK?Ormma._setNetwork(t):i===MSG_TYPE_ERROR&&(h=JSON.parse(t),Ormma._throwError(h.action,h.message)))}}function reportAdError(n){postToLocal(MSG_TYPE_ERROR+":"+n)}function postToLocal(n){localCompartment!==null&&localCompartment.postMessage(adControlId+":"+n,localCompartmentOrigin)}var localCompartment=null,localCompartmentOrigin="ms-appx://"+document.location.host,adControlId=null,adParams=null,prmParams=null,pointerDown=!1,appParams=null,MSG_TYPE_SCRIPT="script",MSG_TYPE_ADPARAMS="adParams",MSG_TYPE_PRMPARAMS="prmParams",MSG_TYPE_APPPARAMS="appParams",MSG_TYPE_INIT="init",MSG_TYPE_SETID="setId",MSG_TYPE_ERROR="error",MSG_TYPE_SETMAXSIZE="setMaxSize",MSG_TYPE_SETSCREENSIZE="setScreenSize",MSG_TYPE_SETSIZE="setSize",MSG_TYPE_SETSTATE="setState",MSG_TYPE_START="ormmaStart",MSG_TYPE_ORMMA_RESPONSE="ormmaResponse",MSG_TYPE_FIRESHAKE="fireShake",MSG_TYPE_UPDATETILTCOORDS="updateTiltCoords",MSG_TYPE_UPDATEORIENTATION="updateOrienation",MSG_TYPE_VIEWABLECHANGE="viewableChange",MSG_TYPE_SETNETWORK="setNetwork",MSG_TYPE_SETLOCALE="setLocale",MSG_TYPE_SETSDKINFO="setSdkInfo",MSG_TYPE_SETCAPABILITY="setCapability",MSG_TYPE_SETADINSTANCESTATE="setAdInstanceState",MSG_TYPE_ONPOINTERDOWN="MSPointerDown",MSG_TYPE_ONPOINTERUP="MSPointerUp",MSG_TYPE_ADINITIALIZED="adInitialized",bubblePointerEvents;window.addEventListener("message",receiveMessage),bubblePointerEvents=location.search.match(/bubblePointerEvents=1/ig)!==null,bubblePointerEvents&&(document.body.addEventListener("MSPointerDown",function(n){pointerDown=!0,postToLocal(MSG_TYPE_ONPOINTERDOWN+":"+JSON.stringify({clientX:n.clientX,clientY:n.clientY}))},!1),document.body.addEventListener("MSPointerUp",function(){pointerDown=!1,postToLocal(MSG_TYPE_ONPOINTERUP)},!1),document.body.addEventListener("MSPointerCancel",function(){pointerDown=!1,postToLocal(MSG_TYPE_ONPOINTERUP)},!1),document.body.addEventListener("MSPointerOut",function(){pointerDown&&(pointerDown=!1,postToLocal(MSG_TYPE_ONPOINTERUP))},!1),document.body.addEventListener("MSLostPointerCapture",function(){pointerDown=!1,postToLocal(MSG_TYPE_ONPOINTERUP)},!1));